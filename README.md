# Optimizing information transmission in optogenetic Wnt signaling

Work performed by Bauer Group at TU Delft and Max Wilson lab at UCSB.

# Reference
This repository contains the code and data accompanying the paper:

O. Witteveen, S.J. Rosen, R.S. Lach, M.Z. Wilson, M. Bauer, Optimizing information transmission in optogenetic Wnt signaling, Physical Review Research (2026). Available at: https://link.aps.org/doi/10.1103/f7qj-f7qy

## Overview

All code and processed experimental data needed to reproduce the figures are contained in this repository. 

### Folders:
- `figures/`: all paper figures, can be generated by `figure_notebook.ipynb`.
- `on_time_experiment_data/`: processed experimental data (single-cell TopFlash data in `g.pkl` and the corresponding on-time condition in `t.pkl`). The file `optimal_priors.pkl` contains the numerically obtained optimal priors as a function of the effective noise. 
- `fine_tuning/`: numerical results used to plot Figs. 6 and 9. Mutual information as a function of peak positions in the optimal prior. 
- `spatial_data/`: processed experimental data from a repeat experiment for 12.5 hours opto-Wnt. Contains TopFlash expression in `g.npy` and the associated xy-coordinates `coordinates.npy`. 

### Notebooks
- `figure_notebook.ipynb`: code to generate all paper figures. 
- `prior_optimization_example.ipynb`: standalone notebook with an example for how to implement the Blahut-Arimoto algorithm and its adaptation for discrete priors. 

### Scripts
- `blahut.py`: script containing a standard Blahut-Arimoto implementation and tools to implement an adapted version for discrete priors. 

In particular, the Jupyter notebook `figure_notebook.ipynb` reproduces the paper figures using the experimental data contained in 

## Repository structure
```
├── figures/ 	
│   ├── Fig1A.pdf 
│   ├── ...
│   └── Fig9C.pdf
├── fine_tuning/ 
│   ├── fine_tuning_fixed_weights.npy
|	└── fine_tuning_variable_weights.npy
├── on_time_experiment_data/ 
│   ├── g.pkl
|	└── t.pkl
├── spatial_data/ 
│   ├── coordinates.npy
|	└── g.npy
├── blahut.py
├── optimal_priors.pkl
├── figure_notebook.ipynb
├── prior_optimization_example.ipynb
├── LICENSE.md
└── README.md 
```

## License
Distributed under the CC BY 4.0 License. See `LICENSE.md` for more information.

## Contact
For any questions or inquiries, please contact o.z.j.witteveen@tudelft.nl or m.s.bauer@tudelft.nl.